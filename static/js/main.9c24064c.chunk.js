(this["webpackJsonpbuy-bch"]=this["webpackJsonpbuy-bch"]||[]).push([[0],{25:function(e,t,r){},44:function(e,t,r){},45:function(e,t,r){},46:function(e,t,r){},47:function(e,t,r){},48:function(e,t,r){},49:function(e,t,r){},50:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(1),c=r.n(a),s=r(19),o=r.n(s),u=(r(25),r(2)),i=r.n(u),l=r(4),d=r(3),b=r(6),p=r.n(b),j=function(){var e=Object(l.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.get("/rate/bchbgn?amount_bgn="+t);case 2:return r=e.sent,e.abrupt("return",r.data.amount_bch);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(l.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.get("/order/"+t);case 3:return r=e.sent,e.abrupt("return",r.data);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(l.a)(i.a.mark((function e(t,r,n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.post("/order",{bgn_amount:t,bch_addr:r,email:n});case 3:return a=e.sent,e.abrupt("return",{order:a.data});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",x(e.t0,503,"Insuffiecient BCH reserves in the service to fulfill the order. Please decrease the amount or try again later"));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r,n){return e.apply(this,arguments)}}(),O=function(){var e=Object(l.a)(i.a.mark((function e(t,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.post("/order/"+t+"/id/phone",{phone:r});case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",x(e.t0,400,"Phone number is not formed correctly. Please follow the example: +359888123456"));case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,r){return e.apply(this,arguments)}}(),m=function(){var e=Object(l.a)(i.a.mark((function e(t,r,n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.post("/order/"+t+"/id/phone",{phone:r,secret_code:n});case 3:return a=e.sent,e.abrupt("return",{order:a.data});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",x(e.t0,403,"Validation code is invalid. Please try again."));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r,n){return e.apply(this,arguments)}}(),v=function(){var e=Object(l.a)(i.a.mark((function e(t,r,n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.post("/order/"+t+"/id/"+n,r,{headers:{"Content-Type":r.type}});case 3:return a=e.sent,e.abrupt("return",{order:a.data});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",x(e.t0,400,"Photo is of wrong format. Please try again."));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r,n){return e.apply(this,arguments)}}(),x=function(e,t,r){return{errorMessage:e.response&&e.response.status===t?r:"Unexpected error. Please contactsystem administrator."}},g=(r(44),r(7)),y=r(9),w=(r(45),function(e){var t=e.children,r=(e.inverted,Object(y.a)(e,["children","inverted"]));return Object(n.jsx)("button",Object(g.a)(Object(g.a)({className:"custom-button"},r),{},{children:t}))}),S=(r(46),function(e){var t=e.handleChange,r=e.label,a=(e.shrink,Object(y.a)(e,["handleChange","label","shrink"]));return Object(n.jsxs)("div",{className:"group",children:[Object(n.jsx)("input",Object(g.a)({className:"form-input",onChange:t},a)),r?Object(n.jsx)("label",{className:"".concat(a.value.length?"shrink":""," form-input-label"),children:r}):null]})}),k=(r(47),function(){return Object(n.jsx)("div",{className:"spinner-overlay",children:Object(n.jsx)("div",{className:"spinner-container"})})});r(8);var N=function(e){var t=e.setOrder,r=Object(a.useState)(""),c=Object(d.a)(r,2),s=c[0],o=c[1],u=Object(a.useState)(""),b=Object(d.a)(u,2),p=b[0],f=b[1],O=Object(a.useState)(""),m=Object(d.a)(O,2),v=m[0],x=m[1],g=Object(a.useState)(""),y=Object(d.a)(g,2),N=y[0],C=y[1],_=Object(a.useState)(""),P=Object(d.a)(_,2),I=P[0],M=P[1],B=Object(a.useState)(!1),T=Object(d.a)(B,2),U=T[0],q=T[1],A=Object(a.useRef)(!1);Object(a.useEffect)((function(){if(A.current){var e=setTimeout(Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(s);case 2:t=e.sent,C(t);case 4:case"end":return e.stop()}}),e)}))),1e3);return function(){return clearTimeout(e)}}A.current=!0}),[s]);var D=function(){var e=Object(l.a)(i.a.mark((function e(r){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),q(!0),e.next=4,h(s,v,p);case 4:n=e.sent,q(!1),n.order?(localStorage.setItem("orderId",n.order.id),t(n.order)):n.errorMessage&&M(n.errorMessage);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return U?Object(n.jsx)(k,{}):Object(n.jsxs)("div",{className:"new-order",children:[Object(n.jsxs)("form",{onSubmit:D,children:[Object(n.jsx)(S,{name:"email",type:"email",handleChange:function(e){f(e.target.value)},value:p,label:"Your Email",required:!0}),Object(n.jsx)(S,{name:"bchAddress",type:"bchAddress",handleChange:function(e){x(e.target.value)},value:v,label:"Your Bitcoin Cash Wallet Address",required:!0}),Object(n.jsx)(S,{name:"bgn",type:"number",step:"0.001",handleChange:function(e){o(e.target.value)},value:s,label:"Amount of BGN you want to spend",required:!0,max:"9999",min:"1"}),Object(n.jsx)(S,{name:"bch",type:"text",value:N?N.toString():"",label:"Estimated amount of BCH you will receive",readOnly:!0}),Object(n.jsxs)("div",{className:"group",children:[Object(n.jsx)("input",{type:"checkbox",required:!0,name:"termsConditions"}),Object(n.jsxs)("label",{children:["I Accept"," ",Object(n.jsx)("a",{href:"",children:"Terms and Conditions"})]})]}),Object(n.jsx)("div",{className:"buttons",children:Object(n.jsx)(w,{type:"submit",children:" Buy BCH "})})]}),I?Object(n.jsx)("p",{className:"error-message",children:I}):null]})},C=(r(48),function(e){var t=e.paymentUrl;return Object(n.jsxs)("div",{className:"new-order",children:[Object(n.jsx)("p",{children:"Thank you for your order"}),Object(n.jsxs)("div",{className:"buttons",children:[Object(n.jsx)(w,{onClick:function(){return window.open(t,"_blank")},children:"Pay here"}),Object(n.jsx)(w,{onClick:function(){localStorage.removeItem("orderId"),window.location.reload()},children:"New Order"})]})]})});var _=function(e){var t=e.orderId,r=e.setOrder,c=Object(a.useState)(""),s=Object(d.a)(c,2),o=s[0],u=s[1],b=Object(a.useState)(""),p=Object(d.a)(b,2),j=p[0],f=p[1],h=Object(a.useState)(!1),v=Object(d.a)(h,2),x=v[0],g=v[1],y=Object(a.useState)(""),k=Object(d.a)(y,2),N=k[0],C=k[1],_=function(){var e=Object(l.a)(i.a.mark((function e(n){var a,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),C(""),!x){e.next=9;break}return e.next=5,m(t,o,j);case 5:(a=e.sent).order?r(a.order):a.errorMessage&&C(a.errorMessage),e.next=13;break;case 9:return e.next=11,O(t,o);case 11:(c=e.sent)?C(c.errorMessage):g(!x);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsxs)("div",{className:"new-order",children:[Object(n.jsxs)("form",{onSubmit:_,children:[Object(n.jsx)(S,{name:"phoneNumber",type:"text",handleChange:function(e){u(e.target.value)},value:o,label:"Your Phone Number (e.g. +359888123456)",required:!0}),x?Object(n.jsx)(S,{name:"validationCode",type:"text",handleChange:function(e){f(e.target.value)},value:j,label:"SMS Code",required:!0}):null,Object(n.jsx)("div",{className:"buttons",children:Object(n.jsx)(w,{type:"submit",children:" Submit "})})]}),N?Object(n.jsx)("p",{className:"error-message",children:N}):null]})};r(49);var P=function(e){var t=e.orderId,r=e.setOrder,c=e.photoSuffix,s=e.declarationFormUrl,o=Object(a.useState)(null),u=Object(d.a)(o,2),b=u[0],p=u[1],j=Object(a.useState)(0),f=Object(d.a)(j,2),h=f[0],O=f[1],m=Object(a.useState)(""),x=Object(d.a)(m,2),g=x[0],y=x[1],k=function(){var e=Object(l.a)(i.a.mark((function e(n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),y(""),e.next=4,v(t,b,c);case 4:(a=e.sent).order?(p(null),O(0===h?1+h:h-1),r(a.order)):a.errorMessage&&y(a.errorMessage);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsxs)("div",{className:"new-order",children:[Object(n.jsxs)("p",{children:["Please upload a ",("id_photo"===c?"photo of your ID":"face_photo"===c?"selfie":"declaration_form"===c?"a photo copy of your declaration form":void 0)+" in PNG or JPEG format"]}),Object(n.jsxs)("form",{onSubmit:k,children:[Object(n.jsx)(S,{name:"photo",type:"file",handleChange:function(e){if(e.target.files&&e.target.files[0]){var t=e.target.files[0];p(t)}},required:!0},h),b?Object(n.jsx)("img",{alt:"To upload",src:URL.createObjectURL(b)}):null,s?Object(n.jsxs)("p",{children:["Please download declaration form from"," ",Object(n.jsx)("a",{href:s,children:"here"})]}):null,Object(n.jsx)("div",{className:"buttons",children:Object(n.jsx)(w,{type:"submit",children:" UPLOAD "})})]}),g?Object(n.jsx)("p",{className:"error-message",children:g}):null]})};var I=function(){var e=Object(a.useState)({}),t=Object(d.a)(e,2),r=t[0],c=t[1];return Object(a.useEffect)((function(){var e=localStorage.getItem("orderId");if(e){function t(){return(t=Object(l.a)(i.a.mark((function t(){var r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f(e);case 2:r=t.sent,console.log(r),c(r);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}}),[]),Object(n.jsx)("div",{className:"App",children:function(){if("pending_payment"===r.status)return Object(n.jsx)(C,{paymentUrl:r.payment_url});if("pending_id"===r.status){if("phone"===r.id_pending)return Object(n.jsx)(_,{orderId:r.id,setOrder:c});if("id_photo"===r.id_pending||"face_photo"===r.id_pending||"declaration_form"===r.id_pending)return Object(n.jsx)(P,{orderId:r.id,setOrder:c,photoSuffix:r.id_pending,declarationFormUrl:r.id_ext_url})}return Object(n.jsx)(N,{setOrder:c})}()})},M=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,51)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;r(e),n(e),a(e),c(e),s(e)}))};o.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(I,{})}),document.getElementById("root")),M()},8:function(e,t,r){}},[[50,1,2]]]);
//# sourceMappingURL=main.9c24064c.chunk.js.map