(this["webpackJsonpbuy-bch"]=this["webpackJsonpbuy-bch"]||[]).push([[0],{19:function(e,t,r){},35:function(e){e.exports=JSON.parse('{"order.email":"\u0412\u0430\u0448\u0438\u044f\u0442 \u0438\u043c\u0435\u0439\u043b \u0430\u0434\u0440\u0435\u0441","order.bchAddress":"\u0412\u0430\u0448\u0438\u044f\u0442 \u0411\u0438\u0442\u043a\u043e\u0439\u043d \u041a\u0435\u0448 \u0430\u0434\u0440\u0435\u0441","order.bgnAmount":"Amount of BGN you want to spend","order.bchAmount":"Estimated amount of BCH you will receive","order.termAndConditions":"I Accept <a>Terms and Conditions</a>","order.buyButton":"BUY BCH","phone.number":"Your Phone Number (e.g. +359888123456)","phone.smsCode":"SMS Code","phone.submit":"submit","photo.typeId":"Please upload a photo of your ID in PNG or JPEG format","photo.typeFace":"Please upload a selfie in PNG or JPEG format","photo.typeDeclaration":"Please upload a photo copy of your declaration form in PNG or JPEG format","photo.declarationUrl":"Please download your declaration form <a>here</a>","photo.upload":"upload","payment.thankYou":"Thank you for your order","payment.payHere":"Pay here","payment.newOrder":"New Order","bchapi.error.general":"Unexpected error. Please contact system administrator.","bchapi.error.notEnoughBch":"Insuffiecient BCH reserves in the service to fulfill the order. Please decrease the amount or try again later","bchapi.error.phoneNumber":"Phone number is not formed correctly. Please follow the example: +359888123456","bchapi.error.validationCode":"Validation code is invalid. Please try again.","bchapi.error.photoFormat":"Photo is of wrong format. Please try again."}')},36:function(e){e.exports=JSON.parse('{"order.email":"Your Email","order.bchAddress":"Your Bitcoin Cash Wallet Address","order.bgnAmount":"Amount of BGN you want to spend","order.bchAmount":"Estimated amount of BCH you will receive","order.termAndConditions":"I Accept <a>Terms and Conditions</a>","order.buyButton":"BUY BCH","phone.number":"Your Phone Number (e.g. +359888123456)","phone.smsCode":"SMS Code","phone.submit":"submit","photo.typeId":"Please upload a photo of your ID in PNG or JPEG format","photo.typeFace":"Please upload a selfie in PNG or JPEG format","photo.typeDeclaration":"Please upload a photo copy of your declaration form in PNG or JPEG format","photo.declarationUrl":"Please download your declaration form <a>here</a>","photo.upload":"upload","payment.thankYou":"Thank you for your order","payment.payHere":"Pay here","payment.newOrder":"New Order","bchapi.error.general":"Unexpected error. Please contact system administrator.","bchapi.error.notEnoughBch":"Insuffiecient BCH reserves in the service to fulfill the order. Please decrease the amount or try again later","bchapi.error.phoneNumber":"Phone number is not formed correctly. Please follow the example: +359888123456","bchapi.error.validationCode":"Validation code is invalid. Please try again.","bchapi.error.photoFormat":"Photo is of wrong format. Please try again."}')},45:function(e,t,r){},64:function(e,t,r){},65:function(e,t,r){},68:function(e,t,r){},69:function(e,t,r){},70:function(e,t,r){},71:function(e,t,r){},72:function(e,t,r){},73:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(1),o=r.n(a),c=r(34),s=r.n(c),i=(r(45),r(5)),u=r.n(i),d=r(8),l=r(6),p=r(13),b=r.n(p),h="https://api-stage.buybch.poype.io",f=function(){var e=Object(d.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("".concat(h,"/rate/bchbgn?amount_bgn=").concat(t));case 3:return r=e.sent,e.abrupt("return",r.data.amount_bch);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{errorId:"bchapi.error.general"});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(d.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("".concat(h,"/order/").concat(t));case 3:return r=e.sent,e.abrupt("return",r.data);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{errorId:"bchapi.error.general"});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(d.a)(u.a.mark((function e(t,r,n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.post("".concat(h,"/order"),{bgn_amount:t,bch_addr:r,email:n});case 3:return a=e.sent,e.abrupt("return",{order:a.data});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",x(e.t0,503,"bchapi.error.notEnoughBch"));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r,n){return e.apply(this,arguments)}}(),O=function(){var e=Object(d.a)(u.a.mark((function e(t,r){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.post("".concat(h,"/order/").concat(t,"/id/phone"),{phone:r});case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",x(e.t0,400,"bchapi.error.phoneNumber"));case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,r){return e.apply(this,arguments)}}(),v=function(){var e=Object(d.a)(u.a.mark((function e(t,r,n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.post("".concat(h,"/order/").concat(t,"/id/phone"),{phone:r,secret_code:n});case 3:return a=e.sent,e.abrupt("return",{order:a.data});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",x(e.t0,403,"bchapi.error.validationCode"));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r,n){return e.apply(this,arguments)}}(),g=function(){var e=Object(d.a)(u.a.mark((function e(t,r,n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.post("".concat(h,"/order/").concat(t,"/id/").concat(n),r,{headers:{"Content-Type":r.type}});case 3:return a=e.sent,e.abrupt("return",{order:a.data});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",x(e.t0,400,"bchapi.error.photoFormat"));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r,n){return e.apply(this,arguments)}}(),x=function(e,t,r){return{errorId:e.response&&e.response.status===t?r:"bchapi.error.general"}},y=(r(64),r(65),r(77)),w=r(35),C=r(36),N=o.a.createContext(),P=function(e){return/^bg\b/.test(e)?w:C},S=navigator.language,I=function(e){var t=Object(a.useState)(S),r=Object(l.a)(t,2),o=r[0],c=r[1],s=Object(a.useState)(P(S)),i=Object(l.a)(s,2),u=i[0],d=i[1];return Object(n.jsx)(N.Provider,{value:{locale:o,selectLanguage:function(e){c(e),d(P(e))}},children:Object(n.jsx)(y.a,{messages:u,locale:o,children:e.children})})},k=function(){var e=Object(a.useContext)(N);return Object(n.jsx)("div",{className:"header-container",children:Object(n.jsxs)("div",{className:"options-container",children:[Object(n.jsx)("div",{className:"option",onClick:function(){return e.selectLanguage("bg-BG")},children:"\u0411\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438"}),Object(n.jsx)("div",{className:"option",onClick:function(){return e.selectLanguage("en")},children:"English"})]})})},M=r(17),_=r(22),A=(r(68),function(e){var t=e.children,r=(e.inverted,Object(_.a)(e,["children","inverted"]));return Object(n.jsx)("button",Object(M.a)(Object(M.a)({className:"custom-button"},r),{},{children:t}))}),B=(r(69),function(e){var t=e.handleChange,r=e.label,a=(e.shrink,Object(_.a)(e,["handleChange","label","shrink"]));return Object(n.jsxs)("div",{className:"group",children:[Object(n.jsx)("input",Object(M.a)({className:"form-input",onChange:t},a)),r?Object(n.jsx)("label",{className:"".concat(a.value.length?"shrink":""," form-input-label"),children:r}):null]})}),E=(r(70),function(){return Object(n.jsx)("div",{className:"spinner-overlay",children:Object(n.jsx)("div",{className:"spinner-container"})})}),G=r(76);r(19);var U=function(e){var t=e.setOrder,r=Object(a.useState)(""),o=Object(l.a)(r,2),c=o[0],s=o[1],i=Object(a.useState)(""),p=Object(l.a)(i,2),b=p[0],h=p[1],m=Object(a.useState)(""),O=Object(l.a)(m,2),v=O[0],g=O[1],x=Object(a.useState)(""),y=Object(l.a)(x,2),w=y[0],C=y[1],N=Object(a.useState)(""),P=Object(l.a)(N,2),S=P[0],I=P[1],k=Object(a.useState)(!1),M=Object(l.a)(k,2),_=M[0],U=M[1],F=Object(a.useRef)(!1),T=Object(G.a)();Object(a.useEffect)((function(){if(F.current){var e=setTimeout(Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(c);case 2:t=e.sent,C(t);case 4:case"end":return e.stop()}}),e)}))),1e3);return function(){return clearTimeout(e)}}F.current=!0}),[c]);var J=function(){var e=Object(d.a)(u.a.mark((function e(r){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),U(!0),e.next=4,j(c,v,b);case 4:n=e.sent,U(!1),n.order?(localStorage.setItem("orderId",n.order.id),t(n.order)):n.errorId&&I(T.formatMessage({id:n.errorId}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return _?Object(n.jsx)(E,{}):Object(n.jsxs)("div",{className:"new-order",children:[Object(n.jsxs)("form",{onSubmit:J,children:[Object(n.jsx)(B,{name:"email",type:"email",handleChange:function(e){h(e.target.value)},value:b,label:T.formatMessage({id:"order.email"}),required:!0}),Object(n.jsx)(B,{name:"bchAddress",type:"bchAddress",handleChange:function(e){g(e.target.value)},value:v,label:T.formatMessage({id:"order.bchAddress"}),required:!0}),Object(n.jsx)(B,{name:"bgn",type:"number",step:"0.001",handleChange:function(e){s(e.target.value)},value:c,label:T.formatMessage({id:"order.bgnAmount"}),required:!0,max:"9999",min:"1"}),Object(n.jsx)(B,{name:"bch",type:"text",value:w?w.toString():"",label:T.formatMessage({id:"order.bchAmount"}),readOnly:!0}),Object(n.jsxs)("div",{className:"group",children:[Object(n.jsx)("input",{type:"checkbox",required:!0,name:"termsConditions"}),Object(n.jsx)("label",{children:T.formatMessage({id:"order.termAndConditions"},{a:function(e){return Object(n.jsx)("a",{href:"",children:e})}})})]}),Object(n.jsx)("div",{className:"buttons",children:Object(n.jsx)(A,{type:"submit",children:T.formatMessage({id:"order.buyButton"})})})]}),S?Object(n.jsx)("p",{className:"error-message",children:S}):null]})},F=(r(71),function(e){var t=e.paymentUrl,r=Object(a.useReducer)((function(e){return 0===e?e+1:e-1}),0),o=Object(l.a)(r,2)[1],c=Object(G.a)();return Object(n.jsxs)("div",{className:"new-order",children:[Object(n.jsx)("p",{children:c.formatMessage({id:"payment.thankYou"})}),Object(n.jsxs)("div",{className:"buttons",children:[Object(n.jsx)(A,{onClick:function(){window.open(t,"_blank"),localStorage.setItem("new-order-button-visible",!0),setTimeout(o,1e3)},children:c.formatMessage({id:"payment.payHere"})}),localStorage.getItem("new-order-button-visible")?Object(n.jsx)(A,{onClick:function(){localStorage.clear(),window.location.reload()},children:c.formatMessage({id:"payment.newOrder"})}):null]})]})});var T=function(e){var t=e.orderId,r=e.setOrder,o=Object(a.useState)(""),c=Object(l.a)(o,2),s=c[0],i=c[1],p=Object(a.useState)(""),b=Object(l.a)(p,2),h=b[0],f=b[1],m=Object(a.useState)(!1),j=Object(l.a)(m,2),g=j[0],x=j[1],y=Object(a.useState)(""),w=Object(l.a)(y,2),C=w[0],N=w[1],P=Object(G.a)(),S=function(){var e=Object(d.a)(u.a.mark((function e(n){var a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),N(""),!g){e.next=9;break}return e.next=5,v(t,s,h);case 5:(a=e.sent).order?r(a.order):a.errorId&&N(P.formatMessage({id:a.errorId})),e.next=13;break;case 9:return e.next=11,O(t,s);case 11:(o=e.sent)?N(P.formatMessage({id:o.errorId})):x(!g);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsxs)("div",{className:"new-order",children:[Object(n.jsxs)("form",{onSubmit:S,children:[Object(n.jsx)(B,{name:"phoneNumber",type:"text",handleChange:function(e){i(e.target.value)},value:s,label:P.formatMessage({id:"phone.number"}),required:!0}),g?Object(n.jsx)(B,{name:"validationCode",type:"text",handleChange:function(e){f(e.target.value)},value:h,label:P.formatMessage({id:"phone.smsCode"}),required:!0}):null,Object(n.jsx)("div",{className:"buttons",children:Object(n.jsx)(A,{type:"submit",children:P.formatMessage({id:"phone.submit"})})})]}),C?Object(n.jsx)("p",{className:"error-message",children:C}):null]})};r(72);var J=function(e){var t=e.orderId,r=e.setOrder,o=e.photoSuffix,c=e.declarationFormUrl,s=Object(a.useState)(null),i=Object(l.a)(s,2),p=i[0],b=i[1],h=Object(a.useState)(0),f=Object(l.a)(h,2),m=f[0],j=f[1],O=Object(a.useState)(""),v=Object(l.a)(O,2),x=v[0],y=v[1],w=Object(G.a)(),C=function(){var e=Object(d.a)(u.a.mark((function e(n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),y(""),e.next=4,g(t,p,o);case 4:(a=e.sent).order?(b(null),j(0===m?1+m:m-1),r(a.order)):a.errorId&&y(w.formatMessage({id:a.errorId}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsxs)("div",{className:"new-order",children:[Object(n.jsx)("p",{children:w.formatMessage({id:"id_photo"===o?"photo.typeId":"face_photo"===o?"photo.typeFace":"declaration_form"===o?"photo.typeDeclaration":void 0})}),Object(n.jsxs)("form",{onSubmit:C,children:[Object(n.jsx)(B,{name:"photo",type:"file",handleChange:function(e){if(e.target.files&&e.target.files[0]){var t=e.target.files[0];b(t)}},required:!0},m),p?Object(n.jsx)("img",{alt:"To upload",src:URL.createObjectURL(p)}):null,c?Object(n.jsx)("p",{children:w.formatMessage({id:"photo.declarationUrl"},{a:function(e){return Object(n.jsx)("a",{href:c,children:e})}})}):null,Object(n.jsx)("div",{className:"buttons",children:Object(n.jsx)(A,{type:"submit",children:w.formatMessage({id:"photo.upload"})})})]}),x?Object(n.jsx)("p",{className:"error-message",children:x}):null]})};var D=function(){var e=Object(a.useState)({}),t=Object(l.a)(e,2),r=t[0],o=t[1];return Object(a.useEffect)((function(){var e=localStorage.getItem("orderId");if(e){function t(){return(t=Object(d.a)(u.a.mark((function t(){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m(e);case 2:r=t.sent,console.log(r),o(r);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}}),[]),Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)(k,{}),function(){if("pending_payment"===r.status)return Object(n.jsx)(F,{paymentUrl:r.payment_url});if("pending_id"===r.status){if("phone"===r.id_pending)return Object(n.jsx)(T,{orderId:r.id,setOrder:o});if("id_photo"===r.id_pending||"face_photo"===r.id_pending||"declaration_form"===r.id_pending)return Object(n.jsx)(J,{orderId:r.id,setOrder:o,photoSuffix:r.id_pending,declarationFormUrl:r.id_ext_url})}return Object(n.jsx)(U,{setOrder:o})}()]})},H=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,78)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,o=t.getLCP,c=t.getTTFB;r(e),n(e),a(e),o(e),c(e)}))};s.a.render(Object(n.jsx)(I,{children:Object(n.jsx)(o.a.StrictMode,{children:Object(n.jsx)(D,{})})}),document.getElementById("root")),H()}},[[73,1,2]]]);
//# sourceMappingURL=main.36ee2caa.chunk.js.map